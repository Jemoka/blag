<!doctype html><html lang=en-us><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="IE=edge"><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Commissioner:wght@100;300;400;500;700&family=IBM+Plex+Sans:ital,wght@0,100;0,300;0,400;0,500;0,700;1,300;1,400;1,500;1,700&display=swap" rel=stylesheet><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSR7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg==" crossorigin=anonymous referrerpolicy=no-referrer><script src=https://code.jquery.com/jquery-3.6.0.min.js integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin=anonymous></script><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Jost:ital,wght@0,100;0,300;0,400;0,500;0,700;1,300;1,400;1,500;1,700&display=swap" rel=stylesheet><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><script>window.MathJax={loader:{load:["[tex]/physics"]},tex:{packages:{"[+]":["physics"]}}}</script><title>adaptive importance sampling</title>
<meta name=description content="Some more improvements to Importance Sampling.
Cross Entropy Method

draw initial samples
fit a new distribution with the subset that failed: weight each sample by

\begin{equation}
w\qty(\tau) = \frac{p\qty(\tau) \qty {\tau \not \in \psi}}{q\qty(\tau)}
\end{equation}
problem: what if, immediately on the first proposal, we never got any failures? Then the weight of everything is zero and then life is bad.
adaptive cross entropy method with adaptive importance sampling
Pick a notion of &ldquo;distance to failure&rdquo; \(f\qty(\tau)\)"><meta name=author content="Houjun Liu"><link rel=stylesheet href=/css/global.css><link rel=stylesheet href=/css/syntax.css></head><body><div class=center-clearfix><header><span id=header-name onclick='window.location.href="/"' style=cursor:pointer>Houjun Liu</span><div id=socialpanel><a href=https://www.jemoka.com/search/ class=header-social id=header-search><i class="ic fa-solid fa-magnifying-glass"></i></i></a>
<a href=https://github.com/Jemoka/ class=header-social id=header-github><i class="ic fa-brands fa-github"></i></a>
<a href=https://bsky.app/profile/jemoka.com class=header-social id=header-twitter><i class="ic fa-brands fa-bluesky"></i></a>
<a href=https://www.reddit.com/user/Jemoka/ class=header-social id=header-reddit><i class="ic fa-brands fa-reddit"></i></a></div></header><div id=title><h1>adaptive importance sampling</h1><span class=tagbox></span></div><aside id=toc><h1 id=toc-title>table of contents</h1><nav id=TableOfContents><ul><li><a href=#cross-entropy-method--kbhcross-entropy-method-dot-md><a href=HAHAHUGOSHORTCODE41s1HBHB>Cross Entropy Method</a></a></li><li><a href=#adaptive-cross-entropy-method-with-adaptive-importance-sampling>adaptive cross entropy method with adaptive importance sampling</a></li></ul></nav></aside><main><article><div><p>Some more improvements to <a href=/posts/kbhimportance_sampling/>Importance Sampling</a>.</p><h2 id=cross-entropy-method--kbhcross-entropy-method-dot-md><a href=/posts/kbhcross_entropy_method/>Cross Entropy Method</a></h2><ol><li>draw initial samples</li><li>fit a new distribution with the subset that failed: weight each sample by</li></ol><p>\begin{equation}
w\qty(\tau) = \frac{p\qty(\tau) \qty {\tau \not \in \psi}}{q\qty(\tau)}
\end{equation}</p><p><strong>problem</strong>: what if, immediately on the first proposal, we never got any failures? Then the weight of everything is zero and then life is bad.</p><h2 id=adaptive-cross-entropy-method-with-adaptive-importance-sampling>adaptive cross entropy method with adaptive importance sampling</h2><p>Pick a notion of &ldquo;distance to failure&rdquo; \(f\qty(\tau)\)</p><p>We will ask that \(f\qty(\tau) \leq 0\), for failure trajectories&mdash;so that we have \(p\qty(\tau | \tau \not \in \psi) = p\qty(\tau | f\qty(\tau) \leq 0)\).</p><hr><ol><li>draw samples from current proposal</li><li>compute \(f\qty(\tau)\) for each sample and pick top \(m_{\text{elite}}\) samples</li><li>set a threshold \(\gamma\) to be the <strong>highest</strong> (i.e. worst) \(f\qty(\tau)\) of the samples&mdash;remember to <strong>cap at minimum of 0</strong>, otherwise we&rsquo;ll start chopping off the failure region</li><li>compute the next proposal by minimizing the cross entropy of the distribution with \(p\qty(\tau | f\qty(\tau) \leq \gamma)\); we use the threshold instead of binary failure.</li></ol></div></article></main><footer><p id=footer>&copy; 2019-2025 Houjun Liu. Licensed CC BY-NC-SA 4.0.</p></footer></div></body></html>